
<div data-bind="with: mainPerfomanceView">
    <div data-bind="ifnot: prfPartial.isLoadedHstProductionData">loading...</div>
    <div data-bind="if: prfPartial.isLoadedHstProductionData">
        <div data-bind="if: prfPartial.hstProductionDataSet().length === 0">No data. Import files from "File manager" to view production data.</div>
        <div data-bind="if: prfPartial.hstProductionDataSet().length > 0">			
            <!-- Settings panel -->
            <div data-bind="with: prfPartial">
                <div data-bind="if: requiredForecastParamListNaNString" class="text-right">
                    <small>Forecast inaccessible: required parameters:<span data-bind="text: requiredForecastParamListNaNString"></span></small>
                </div>
                <div data-bind="ifnot: requiredForecastParamListNaNString">
                    <div data-bind="with: forecastEvolution">
                        <div data-bind="if: requiredForecastEvoListNaNString" class="text-right">
                            <small>Forecast inaccessible: required evolutions:<span data-bind="text: requiredForecastEvoListNaNString"></span></small>
                        </div>
                    </div>
                    <div class="text-right">
                        <label class="checkbox-inline">
                            <input type="checkbox" data-bind="checked: isVisibleForecastPanel" />Show settings
                        </label>
                    </div>
                    <div data-bind="if: isVisibleForecastPanel" class="text-center">
                        <div class="btn-group">
                            <button type="button" class="btn btn-default btn-sm" data-bind="click: forecastEvolution.save">Save evolution</button>
                            <button type="button" class="btn btn-default btn-sm" data-bind="click: deleteWellProductionData">Delete production data</button>
                        </div>
                        <div>
                            <div class="evo-scope-wrap">
                                <span class="evo-wrap" data-bind="with: forecastEvolution.Dict">
                                    <b>Liquid</b> = <input type="text" class="input-narrow" data-bind="value: LiquidEvolutionA" />
                                    * EXP (<input type="text" class="input-narrow" data-bind="value: LiquidEvolutionB" /> * X)
                                </span>
                                <span class="evo-wrap" title="Corrections to last value = Evolution1 * EXP(Evolution2 * LastPd.LiquidCum)">
                                    Diff = <span data-bind="text: DZADiffLiquid"></span>
                                </span>
                                <span class="evo-wrap" title="Corrections to last value = Diff - LastPd.LiquidRate">
                                    Result = <span data-bind="text: DZADiffLiquidResult"></span>
                                </span>
                            </div>
                            <div class="evo-scope-wrap">
                                <span class="evo-wrap" data-bind="with: forecastEvolution.Dict">
                                    <b>Water cut</b> = <input type="text" class="input-narrow" data-bind="value: WctEvolutionC" />
                                    * Ln(X) - <input type="text" class="input-narrow" data-bind="value: WctEvolutionD" />
                                </span>
                                <span class="evo-wrap" title="Corrections to last value = Evolution1 * Ln(LastPd.OilCum) - Evolution2">
                                    Diff = <span data-bind="text: DZADiffWCT"></span>
                                </span>
                                <span class="evo-wrap" title="Corrections to last value = Diff - LastPd.WaterCut">
                                    Result = <span data-bind="text: DZADiffWCTResult"></span>
                                </span>
                            </div>
                            <div class="evo-scope-wrap">
                                <span class="evo-wrap" data-bind="with: forecastEvolution.Dict">
                                    <b>GOR</b> = <input type="text" class="input-narrow" data-bind="value: GorEvolutionF" />
                                    * Ln(X) + <input type="text" class="input-narrow" data-bind="value: GorEvolutionG" />
                                </span>
                                <span class="evo-wrap" title="Corrections to last value = Evolution1 * Ln(LastPd.OilCum) + Evolution2">
                                    Diff = <span data-bind="text: DZADiffGOR"></span>
                                </span>
                                <span class="evo-wrap" title="Corrections to last value = Diff - LastPd.GOR">
                                    Result = <span data-bind="text: DZADiffGORResult"></span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- / with prfPartial  -->
            <div data-bind="ifnot: selectedAttrGroup">
                Please choose perfomance group:
                <ul data-bind="foreach: $root.wfmParamSquadList">
                    <li data-bind="with: id">
                        <a href="#" data-bind="click: $parent.selectAttrGroupId">
							<span data-bind="text: $data"></span>
						</a>
                    </li>
                </ul>
            </div>
            <div data-bind="if: selectedAttrGroup">
                <div>
                    <div class="clearfix pd-graph-wrap">
  <div class="pull-right pd-graph-vscale">
    <svg version="1.1" width="60px" data-bind="svgAxisValue: {valueBorder: filteredByDateProductionDataSetValueBorder}, attr:{ height: prfGraphHeight }">
      <g class="axis"></g>
    </svg>
  </div>
  <div class="pd-graph-grid">
    <div>
      <svg version="1.1" width="100%" data-bind="attr: { height: prfGraphHeight }, svgResponsive: { ratio: prfPartial.prfGraph.viewBox.ratio, tmpPrfGraphHeight: prfGraphHeight }" viewbox="0 0 1200 400">
        <g class="svg-prf-graph-g" data-bind="foreach: {data: selectedWellGroupWfmParameterList, as: 'groupParam'}">
          <!-- ko with: $parent.productionDataSetSvgPath -->
          <!-- ko if: $data[groupParam.wfmParameterId] -->
          <path d="M0 0" data-bind="attr:{d: $data[groupParam.wfmParameterId], stroke: groupParam.color }" style="stroke-width:1; fill: none"></path>
          <!-- /ko -->
          <!-- /ko -->
        </g>
      </svg>
    </div>
    <div>
      <!--svg-path-line-->
      <svg version="1.1" width="100%" height="20px" data-bind="svgAxisTime: {timeBorder: filteredByDateProductionDataSetTimeBorder, windowSize: $root.windowWidth }">
        <g class="axis"></g>
      </svg>
    </div>
  </div>
</div>
                    <div class="clearfix" style="margin-top:4px">
                        <div class="text-center">
                            <select data-bind="options: joinedYearList, value: WPDDateStartYear" class="input-sm"></select>
                            <select data-bind="options: monthList, value: WPDDateStartMonth" class="input-sm"></select>
                            <span>&nbsp;-&nbsp;</span>
                            <select data-bind="options: joinedYearList, value: WPDDateEndYear" class="input-sm"></select>
                            <select data-bind="options: monthList, value: WPDDateEndMonth" class="input-sm"></select>
                            <label class="checkbox-inline">
                                <input type="checkbox" data-bind="checked: isVisibleForecastData, enable: prfPartial.isForecastPossible" />Show forecast graph and data
                            </label>
                        </div>
                    </div>
                    <table class="table table-condensed">
  <thead>
    <tr>
      <th>Time</th>
      <!-- ko foreach: {data: selectedWellGroupWfmParameterList, as: 'groupParam'} -->
      <th>
        <div>
          <small>
            <i class="glyphicon glyphicon-bookmark" data-bind="style: { color: color }"></i>
          </small>
          <span data-bind="text: groupParam.wfmParameterId"></span>
        </div>
        <div>
          <label class="checkbox-inline">
            <input type="checkbox" title="show/hide" data-bind="checked: isVisible" />Show
          </label>
          <label class="checkbox-inline">
            <input type="checkbox" title="usual/calc" data-bind="checked: isCalc" />Calc
          </label>
        </div>
        <div data-bind="foreach: { data: groupParam.wfmParameter().uomMatrix(), as: 'mtrx' }" class="clearfix">
          <div data-bind="foreach: {data: mtrx, as: 'uomItem' }" class="pull-left">
            <div class="btn-group">
              <button type="button" class="btn btn-default dropdown-toggle btn-sm" data-toggle="dropdown">
                <span data-bind="text: uomItem"></span>
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" data-bind="foreach: {data: groupParam.wfmParameter().getPossibleUomListForSelectedUom(uomItem), as: 'possibleUom'}">
                <li>
                  <a href="#" data-bind="text: possibleUom, click: function(){ groupParam.wfmParameter().changeSelectedUom(possibleUom, $parentContext.$parentContext.$index(), $parentContext.$index()); }"></a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </th>
      <!-- /ko -->
    </tr>
  </thead>
  <tbody>
    <!-- ko foreach: { data: filteredByDateProductionDataSet, as: 'wpd' } -->
    <!-- ko if: isSelectedPrfYear -->
    <tr>
      <td>
        (<span title="Production days" data-bind="text: wpd.ProdDays"></span>)&nbsp;<span data-bind="text: wpd.prfYear + '-' + wpd.prfMonthStr"></span>
      </td>
      <!-- ko foreach: {data: $parent.selectedWellGroupWfmParameterList, as: 'groupParam'} -->
      <td>
        <span data-bind="visible: isVisible, prec: {value: wpd[groupParam.wfmParameterId], coef: groupParam.wfmParameter().uomCoef}"></span>
      </td>
      <!-- /ko -->
    </tr>
    <!-- /ko -->
    <!-- /ko -->
  </tbody>
</table>
                    <div class="text-center">
                        <ul class="pagination pagination-sm" data-bind="foreach: {data: joinedYearList, as: 'joinedYear'}">
                            <li data-bind="visible: joinedYear >= $parent.WPDDateStartYear() && joinedYear <= $parent.WPDDateEndYear(), css: {'active': joinedYear === $parent.selectedPrfTableYear() }">
                                <a href="#" data-bind="text: joinedYear, click: function(){ $parent.selectPrfTableYear(joinedYear);}"></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>